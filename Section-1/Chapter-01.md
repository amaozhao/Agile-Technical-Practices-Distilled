# 结对编程
> 结对程序员：让彼此完成任务。对系统进行头脑风暴改进。理清思路。当他们的伴侣被卡住时采取主动，从而降低挫败感。让彼此对团队的实践负责。
>
> – 肯特贝克

当我开始我的职业生涯时，我从事电视广播软件的工作，主要为体育、新闻等开发计算机图形。不知不觉中，我准备好迎接一个充满压力的挑战，因为我永远不会迟到。

不管怎样，电视广播都会在预定的时间播出，所以软件必须准备好。当截止日期临近时，我记得在漫漫长夜里喝了太多咖啡，和我的朋友 Rui 一起按时交货。当我们精疲力竭而无法继续时，我们会轮流在桌子底下小睡。

我第一次读到配对时，我跳过了这节课，因为这对我来说并不新鲜。我已经这样做了很多年。我能学到什么？

事实证明我错过了很多。我与 Rui 的结对与结对编程的学科几乎没有相似之处。尽管我花了很多时间与他配对，但我从未与其他任何人配对。我们很自然地通过组织自己找到了平衡，所以我们不需要在我们的工作中添加任何结构。事后看来，是最后期限的压力让我们继续前进。

与以前从未合作过的人结对需要更多的结构才能成功。实际上，结对与急于满足特定期限无关！

几年后，我搬到了一个更大的组织。一切都更有条理，我们不需要通宵工作。

该组织有严格的代码审查政策。一旦开发人员完成了他们的任务，他们就会打电话给一位资深的人来检查他们编写的所有代码。不可避免地，审阅者会发现缺陷，他们不同意的事情，开发人员需要进行所有更改以符合要求。

这非常令人沮丧，因为我只会在完成任务后得到反馈。我当时不知道，但这是反馈循环中断的征兆。结对编程尽可能早地引入反馈，从而使我们能够更快地做出反应。

## 什么是结对编程？

结对编程是一种规范的软件编写方法。它为每个配对成员分配特定的角色和职责，定义转换位置的策略，并促进休息以避免配对耗尽自己。

结对编程旨在缩短编写代码时的反馈循环。在我们编写软件时更容易更改软件。为了验证我们的想法，我们可以与公正的同行实时讨论设计选择。如果我们在编写代码时有额外的人进行审查，我们会将反馈循环减少到几秒钟。反馈越快，我们就越快收敛到高质量的解决方案。应用精益思想！

> 警告
>
> 结对编程需要同行的高度成熟。

> 重要的
>
> 结对编程应该是一种选择，而不是强制实践。

## 角色
在结对编程中，每个人轮流担任以下角色之一：

- Driver：负责编码工作，如打字、移动鼠标等。
- Navigator：负责审核驱动的工作，从战略层面看代码，不断提出问题，例如：
    这将如何与其余代码相适应？
    此实现是否需要在其他地方进行更改？
    我们能不能更好地设计这个程序？
    是否有任何意外错误？

> 警告
>
> 如果你处于权力、权威或资历的位置，则有责任确保你的伴侣在与你配对时享受良好的体验。 避免使用你的权力来强加决定或让你的伴侣在与你配对时感到不舒服。

## 驱动器/导航器切换技术
结对编程鼓励参与者经常转换角色。这些程序确保每个人都有机会驾驶和导航。两个合作伙伴在执行每个角色上花费相同的时间是至关重要的。你可以使用一些技巧来鼓励这一点。

### 棋钟

使用国际象棋时钟，两人分配执行每个角色的时间段。当时钟响起或自然断点发生时，这对转换角色。

### 乒乓球/爆米花

1. A 驱动程序（B 导航器）：编写一个新测试并发现它因正确的原因而失败。
2. B Driver（A Navigator）：实现通过测试所需的代码。
3. B 驱动程序（A 导航器）：编写下一个测试并发现它因正确的原因而失败。
4. A Driver（B Navigator）：实现通过测试所需的代码。
5. A 驱动程序（B 导航器）：编写下一个测试并发现它因正确的原因而失败。
6. 冲洗并重复。

> 警告
>
> 如果你不使用乒乓球/爆米花或国际象棋时钟，请使用其他东西来提醒你转换角色。不要仅仅依赖你的伴侣指出你需要改变角色，因为他或她可能不愿意提出要求。

> 强式配对
>
> 一个想法要从你的头脑进入计算机，它必须经过别人的手。
>
> – 卢埃林法尔科

我们来看看 Llewellyn Falco 的强风格配对：https://llewellynfalco.blogspot.com/2014/06/llewellyns-strong-style-pairing.html。

从 Mob 编程的角度来看，我们发现这种配对方式非常有趣，因为需要高度的信任和成熟度。一旦学会了这种技术，mob 编程就会顺利进行。

在这种风格中，驾驶员必须信任导航员，同时对不完整的理解感到满意。司机将按照导航员的指示行事，并允许在所讲内容不清楚时提出问题。讨论为什么应该推迟到想法完全编码；这是可以讨论想法的时候，或者导航员可以就如何继续进行提示。

当导航器具有实现功能的全貌和路线图时，这种样式非常有效。驱动程序可以专注于编写代码并在代码中展开时学习想法。导航员必须在驾驶员准备好实施下一条指令时立即向他们提供下一条指令，并以驾驶员可以理解的最高抽象级别进行交谈。

有时导航员和司机会撞头。当实际问题是司机不信任我时，我经常犯错误，试图争论我的想法的优点。如果你不信任某人，世界上所有的逻辑都无济于事。一个简单的解决方案就是要求一个临时的信任窗口。

## 休息时间
花费大量时间配对可能会非常令人筋疲力尽。在编码时保持沟通渠道畅通是结对必须一直做的一项额外活动。对某人来说微不足道的事情在那个时候对其他人来说可能并不微不足道。经过几次结对迭代后，参与结对编程的人通常会感到疲倦，这会导致清晰度降低和/或结对功能障碍。

永远不要忘记，我们是从事智力密集型任务的人类。作为人类，我们的潜力是非凡的，但我们也不能幸免于失败，尤其是在疲倦时。如果你想在编程时尽力而为，请避免将你的精神耐力超出其界限。可持续的步伐是关键。

重要的

记住在工作时休息，尤其是在配对时。

### 番茄钟

番茄工作法是 1980 年代后期由意大利顾问 Francesco Cirillo 提出的。这是平衡短期工作与定期休息的绝佳方式。 Pomodoro 这个名字来源于人们在厨房里用来跟踪意大利面烹饪时间的机械计时器。当弗朗切斯科开始试验这项技术时，他使用了他在家里找到的定时器，它是番茄形状的（意大利语是番茄钟）。

![](../images/1-1.png)

这项技术有五个步骤：

1. 决定要完成的任务。
2. 将（番茄钟）计时器设置为 n 分钟（传统上为 25 分钟）。
3. 继续完成任务，直到计时器响起。
4. 休息一下（3-5 分钟）。
5. 四个（番茄钟）循环后，休息更长时间（15-30 分钟）。

> 警告
>
> 如果你不使用番茄工作法，请使用其他东西来提醒你定期休息。不要仅仅依赖你的伴侣指出你需要改变角色，因为他或她可能不愿意提出要求。

从单人编程到协同编程的调整期，就像吃辣椒一样。第一次尝试时，你可能不喜欢它，因为你不习惯它。然而，你吃得越多，你就越喜欢它。

– 匿名 XP 从业者

## Katas

还没有练习。享受生活！当你准备好返回时，我们将在这里等你。

## 我应该什么时候进入下一课？

每当你觉得准备好了。

## 资源

### 网络

- Llewellyn 的强风格配对：Llewellyn Falco (https://llewellynfalco.blogspot.com/2014/06/llewellyns-strong-style-pairing.html)。
- Mob 编程和强风格配对：Emily Bache (http://coding-is-like-cooking.info/2016/09/mob-programming-strong-style-pairing/)。
- 结对编程：Marek Kusmin (http://www.kusmin.eu/wiki/index.php/Pair_Programming)。
- 配对技术：Roger Almeida (http://roger-almeida.blogspot.co.uk/2010/04/pairing-techniques.html)。
- 番茄工作法：Francesco Cirillo (http://baomee.info/pdf/technique/1.pdf)。
- 重新思考结对编程：Sandro Manusco (http://codurance.com/2015/03/15/rethinking-pair-programming/)。
- 泰迪熊结对编程：Adrian Bolboacă (http://blog.adrianbolboaca.ro/2012/12/teddy-bear-pair-programming/)。
- 什么是结对编程？：Adrian Bolboacă (http://blog.adrianbolboaca.ro/2013/09/what-is-pair-programming/)。